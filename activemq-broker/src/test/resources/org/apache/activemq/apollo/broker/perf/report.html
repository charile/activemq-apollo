<html>
  <head>
    <style type='text/css'>
      body { font-family:Verdana; font-size:12px; color:#666666; }
      #header {
        margin: 0; padding: 2em; text-align:center; background: #baccd8;
      }
      #header h1 {
        margin: 0; padding: 0; font-size: 180%; line-height: 1em; color: #333;
      }
      #wrap {
        width: 60em; margin: 0 auto; padding: 2em;
        background: #dae3e9;
      }
      #content {
        width: 60em;
        padding: 2em 0;
      }
      .chart-graph {
        float:right; width: 66%; height: 15em;  margin: 1em 0 1em 1em;
      }
      .chart-section { clear:both; margin-top: 1em; padding-left:2em; }
      .clear { clear:both; }
    </style>
    <script type='text/javascript' src='http://www.google.com/jsapi'></script>
    <script type='text/javascript'>
      var cols_index_map = {}
      var data = null;
      google.load('visualization', '1', {'packages':['linechart']});
      google.setOnLoadCallback(function() {
        data = new google.visualization.DataTable();
        data.addColumn('string', 'version');
        data.addColumn('number', 'queue 20 1->1->1 producer');
        data.addColumn('number', 'queue 20 1->1->1 consumer');
        data.addColumn('number', 'queue 20 2->2->2 producer');
        data.addColumn('number', 'queue 20 2->2->2 producer sd');
        data.addColumn('number', 'queue 20 2->2->2 consumer');
        data.addColumn('number', 'queue 20 2->2->2 consumer sd');
        data.addColumn('number', 'queue 20 4->4->4 producer');
        data.addColumn('number', 'queue 20 4->4->4 producer sd');
        data.addColumn('number', 'queue 20 4->4->4 consumer');
        data.addColumn('number', 'queue 20 4->4->4 consumer sd');
        data.addColumn('number', 'queue 20 8->8->8 producer');
        data.addColumn('number', 'queue 20 8->8->8 producer sd');
        data.addColumn('number', 'queue 20 8->8->8 consumer');
        data.addColumn('number', 'queue 20 8->8->8 consumer sd');
        data.addColumn('number', 'queue 20 10->10->10 producer');
        data.addColumn('number', 'queue 20 10->10->10 producer sd');
        data.addColumn('number', 'queue 20 10->10->10 consumer');
        data.addColumn('number', 'queue 20 10->10->10 consumer sd');
        data.addColumn('number', 'queue 20 10->1->1 producer');
        data.addColumn('number', 'queue 20 10->1->1 producer sd');
        data.addColumn('number', 'queue 20 10->1->1 consumer');
        data.addColumn('number', 'queue 20 1->1->10 producer');
        data.addColumn('number', 'queue 20 1->1->10 consumer');
        data.addColumn('number', 'queue 20 1->1->10 consumer sd');
        data.addColumn('number', 'queue 20 10->1->10 producer');
        data.addColumn('number', 'queue 20 10->1->10 producer sd');
        data.addColumn('number', 'queue 20 10->1->10 consumer');
        data.addColumn('number', 'queue 20 10->1->10 consumer sd');
        data.addColumn('number', 'topic 20 1->1->0 producer');
        data.addColumn('number', 'topic 20 1->1->1 producer');
        data.addColumn('number', 'topic 20 1->1->1 consumer');
        data.addColumn('number', 'topic 20 2->2->2 producer');
        data.addColumn('number', 'topic 20 2->2->2 producer sd');
        data.addColumn('number', 'topic 20 2->2->2 consumer');
        data.addColumn('number', 'topic 20 2->2->2 consumer sd');
        data.addColumn('number', 'topic 20 4->4->4 producer');
        data.addColumn('number', 'topic 20 4->4->4 producer sd');
        data.addColumn('number', 'topic 20 4->4->4 consumer');
        data.addColumn('number', 'topic 20 4->4->4 consumer sd');
        data.addColumn('number', 'topic 20 8->8->8 producer');
        data.addColumn('number', 'topic 20 8->8->8 producer sd');
        data.addColumn('number', 'topic 20 8->8->8 consumer');
        data.addColumn('number', 'topic 20 8->8->8 consumer sd');
        data.addColumn('number', 'topic 20 10->10->10 producer');
        data.addColumn('number', 'topic 20 10->10->10 producer sd');
        data.addColumn('number', 'topic 20 10->10->10 consumer');
        data.addColumn('number', 'topic 20 10->10->10 consumer sd');
        data.addColumn('number', 'topic 20 10->1->1 producer');
        data.addColumn('number', 'topic 20 10->1->1 producer sd');
        data.addColumn('number', 'topic 20 10->1->1 consumer');
        data.addColumn('number', 'topic 20 1->1->10 producer');
        data.addColumn('number', 'topic 20 1->1->10 consumer');
        data.addColumn('number', 'topic 20 1->1->10 consumer sd');
        data.addColumn('number', 'topic 20 10->1->10 producer');
        data.addColumn('number', 'topic 20 10->1->10 producer sd');
        data.addColumn('number', 'topic 20 10->1->10 consumer');
        data.addColumn('number', 'topic 20 10->1->10 consumer sd');

        for( var i=0; i <  data.getNumberOfColumns(); i ++) {
          cols_index_map[data.getColumnLabel(i)] = i;
        }

        var data_array = [
// DATA-START
      ['commit f1ce02f4ec7bec08a46319895c4b6b30bc9e73df', 9508.81, 9471.25, 6116.33, 466.50, 7064.00, 1577.00, 8186.94, 4294.59, 5738.09, 1043.13, 6012.67, 2299.88, 6369.00, 1371.98, 6529.00, 1356.70, 2517.33, 528.98, 3104.83, 695.42, 2237.94, 4976.00, 4998.00, 19.68, 3110.00, 481.80, 2014.00, 253.15, 113277.23, 9637.79, 9489.50, 9948.68, 4976.00, 9981.01, 1635.50, 11084.94, 1791.63, 9300.80, 637.45, 9537.33, 602.25, 9084.00, 647.53, 9834.33, 646.34, 8926.00, 486.86, 4983.32, 490.75, 5365.60, 1655.36, 16238.52, 51.49, 0.00, 0.00, 0.00, 0.00]
// DATA-END
        ];
        try {
          data.addRows(data_array);
        } catch (er) {
          alert(er);
        }
      });

      // Helpers
      function chart(id, cols, options) {
        var c = new google.visualization.LineChart(document.getElementById(id));
        var view = new google.visualization.DataView(data);
        var col_indexes = new Array(cols.length);
        for (var i = 0; i < cols.length; i++) {
          col_indexes[i] = cols_index_map[cols[i]];
        }
        view.setColumns(col_indexes);
        c.draw(view, options);
      }
    </script>
  </head>
  <body>
    <div id='wrap'>
      <div id='header'>
        <h1>Broker Performance Evolution</h1>
      </div>

      <div id='content' >
        <p>
          This report is used to visualize the how the performance of the broker
          is changed over time as new code changes are introduced. Click on any data
          point in the charts to get the data point's exact value and git
          commit version.
        </p>

        <h2>General</h2>

        <div class='chart-section'>
          <div id='raw_producer_rate' class='chart-graph'></div>
          <script type='text/javascript'>
            google.setOnLoadCallback(function() {
              chart('raw_producer_rate',
                ['version', 'topic 20 1->1->0 producer'],
                {showCategories:false, legend: 'bottom', smoothLine:true, titleX:'changes over time', titleY:'messages/sec', enableTooltip:true }
              );
            });
          </script>
          <h3>Max Producer Rate</h3>
          The maximum rate that a single producer can send to a broker.  The producer is setup
          on a topic with no consumers.  This rate is has a close correlation to your processor
          speed.
        </div>

        <div class="clear"></div>
        <h2>Queue Performce</h2>
        <p></p>
        <div class='chart-section'>
          <div id='queue_partioned_scaling' class='chart-graph'></div>
          <script type='text/javascript'>
            google.setOnLoadCallback(function() {
              chart('queue_partioned_scaling',
                ['version', 'queue 20 1->1->1 consumer', 'queue 20 2->2->2 consumer', 'queue 20 4->4->4 consumer', 'queue 20 8->8->8 consumer', 'queue 20 10->10->10 consumer'],
                {showCategories:false, legend: 'bottom', smoothLine:true, titleX:'changes over time', titleY:'messages/sec', enableTooltip:true }
              );
            });
          </script>
          <h3>Partitioned Scaling</h3>
          Compares how well the broker scales as partitioned load is increased on it.  Each destination
          has only one producer and one consumer attached.  This should scale up on machines with many
          processing cores. 
        </div>

        <div class='chart-section'>
          <div id='queue_fan_in_rate' class='chart-graph'></div>
          <script type='text/javascript'>
            google.setOnLoadCallback(function() {
              chart('queue_fan_in_rate',
                ['version', 'queue 20 10->1->1 producer', 'queue 20 10->1->1 consumer', 'queue 20 10->1->1 producer sd'],
                {showCategories:false, legend: 'bottom', smoothLine:true, titleX:'changes over time', titleY:'messages/sec', enableTooltip:true }
              );
            });
          </script>
          <h3>Producer Fan In</h3>
          Total producer and consumer rates for when there are many producers on one destination
          but only one consumer.  The 'producer sd' is standard deviation of the message rate across the
          producers.
        </div>


        <div class='chart-section'>
          <div id='queue_fan_out_rate' class='chart-graph'></div>
          <script type='text/javascript'>
            google.setOnLoadCallback(function() {
              chart('queue_fan_out_rate',
                ['version', 'queue 20 1->1->10 producer', 'queue 20 1->1->10 consumer', 'queue 20 1->1->10 consumer sd'],
                {showCategories:false, legend: 'bottom', smoothLine:true, titleX:'changes over time', titleY:'messages/sec', enableTooltip:true }
              );
            });
          </script>
          <h3>Consumer Fan Out</h3>
          Total producer and consumer rates for when there are many consumers on one destination
          but only one producer.  The 'consumer sd' is standard deviation of the message rate across the
          consumers.
        </div>


        <div class='chart-section'>
          <div id='queue_fan_inout_rate' class='chart-graph'></div>
          <script type='text/javascript'>
            google.setOnLoadCallback(function() {
              chart('queue_fan_inout_rate',
                ['version', 'queue 20 10->1->10 producer', 'queue 20 10->1->10 consumer', 'queue 20 10->1->10 producer sd', 'queue 20 10->1->10 consumer sd'],
                {showCategories:false, legend: 'bottom', smoothLine:true, titleX:'changes over time', titleY:'messages/sec', enableTooltip:true }
              );
            });
          </script>
          <h3>Producer Fan In and Consumer Fan Out</h3>
          Total producer and consumer rates for when there are many producers and many consumers on one destination.  The 'consumer sd' and 'producer sd'
          are the standard deviation numbers of the producers and consumers.
        </div>

        <div class="clear"></div>
      </div>
    </div>
  </body>
</html>

