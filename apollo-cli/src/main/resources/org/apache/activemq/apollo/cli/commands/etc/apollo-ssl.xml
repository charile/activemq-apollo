<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements. See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version
  2.0 (the "License"); you may not use this file except in compliance
  with the License. You may obtain a copy of the License at
  http://www.apache.org/licenses/LICENSE-2.0 Unless required by
  applicable law or agreed to in writing, software distributed under
  the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES
  OR CONDITIONS OF ANY KIND, either express or implied. See the
  License for the specific language governing permissions and
  limitations under the License.
-->
<broker id="default" rev="1" xmlns="http://activemq.apache.org/schema/activemq/apollo">

  <notes>
    The default configuration with tls/ssl enabled.
  </notes>

  <!-- used to secure the web admin interface -->
  <authentication domain="apollo"/>
  <acl>
    <admin allow="admins"/>
  </acl>

  <web-admin host="127.0.0.1" port="8080"/>

  <virtual-host id="default" auto-create-queues="true" >
    <!--
      You should add all the host names that this virtual host is known as
      to properly support the STOMP 1.1 virtual host feature.
      -->
    <host-name>localhost</host-name>

    <!-- Uncomment to disable security for the virtual host
    <authentication enabled="false"/>
    -->

    <!--
      You can add an 'acl' element to the virtual host,
      destination, or queue elements to restrict the operations
      that a user can take.  If the acl element is not set on
      an object, then access is not restricted at all.
      -->
    <acl>
      <connect allow="admins"/>
    </acl>
    <destination name="secure.**">
      <acl>
        <create  allow="admins"/>
        <destroy allow="admins"/>
        <send    allow="admins"/>
        <receive allow="admins"/>
      </acl>
    </destination>
    <queue name="secure.**">
      <acl>
        <create  allow="admins"/>
        <destroy allow="admins"/>
        <send    allow="admins"/>
        <receive allow="admins"/> <!-- queue browsers -->
        <consume allow="admins"/> <!-- regular consumers -->
      </acl>
    </queue>

    <!--
      Examples of how to configure destinations and queues. Note
      they you can use wildcard patterns when specifying destinations,
      only the first element that matches will be used to configure the
      destination or queue.
      -->

    <!-- Use this if you expect to have slow consumers on a topic
         allows slow consumers to swap messages to a disk queue -->
    <destination name="slow.**" slow_consumer_policy="queue"/>

    <!-- Use this if you want the queue and topic with of the same name
         to be the same logical entity -->
    <destination name="unified.**" unified="true"/>

    <!-- disable message swapping for some queues -->
    <queue name="noswap.**" kind="ptp" swap="false"/>

    <!-- disable message swapping for durable subscriptions -->
    <queue name="noswap.**" kind="ds" swap="false"/>

    <!-- You can delete this element if you want to disable persistent for this virtual host -->
    <hawtdb-store directory="${apollo.base}/data"/>

  </virtual-host>

  <key-storage file="${apollo.base}/etc/keystore" password="password" key-password="password"/>

  <connector id="tcp" bind="tcp://0.0.0.0:61613" connection-limit="2000" protocol="multi"/>
  <connector id="tls" bind="tls://0.0.0.0:61614" connection-limit="2000" protocol="multi"/>

</broker>
