---
# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

title: Migration Guide
in_menu: true
--- name:overview pipeline:haml,tags

%h1 Migration Guide

Lets keep track of all differences that end users will notice between ActiveMQ 5 and ActiveMQ 6.

--- name:content pipeline:textile

h3. vm:// Transport URI format change:

The VM transport configuration is much simpler now.  It now only supports 2 options:

  * broker: Set to a broker Factory URI used to configure the embedded broker
  * create: If the embedded broker should get created if it does not yet exist.  Defaults to true.

Example: _vm://localhost?broker=jaxb:conf/activemq.xml&create=true_
  
Furthermore, the host name part of the URI does not need to the broker name anymore.  It is just 
the name of the 'pipe' to the broker.  The first VMTransport associate a pipe name with a broker
wins in cases where you have multiple VM client connections trying to crate different broker 
configurations with the same pipe name.  For example you may get non determinist results if:

bq. Client on Thread 1 tries to create a connection to 
    _vm://localhost?broker=jaxb:conf/brokerA.xml_ 
    and concurrently Client on Thread 2 tries to create a connection to 
    _vm://localhost?broker=jaxb:conf/brokerB.xml_

As the first thread to associate the "localhost" pipe name to a broker instance will win and the 
other thread will connect to the first threads broker.